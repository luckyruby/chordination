<h3><%= @participant.scoresheet.name %></h3>
<h4>Deadline: <%= pretty_datetime(@participant.scoresheet.deadline, ampm: true) %></h4>
<% if @participant.scoresheet.message.present? %>
  <div class="well">
    <h4>Message</h4>
    <p class="message"><%= @participant.scoresheet.message %></p>
  </div>
<% end %>
<div class="well">
  <h4>Entries</h4>
  <table class="table table-striped table-hover table-condensed">
    <thead>
      <tr>
        <th>&nbsp;</th>
        <% @bets.each do |b| %>
          <th><%= b.name %></th>
        <% end %>
      </tr>    
    </thead>
    <tbody>
      <% @participants.each do |p| %>
        <tr class="<%= p.id == @participant.id ? 'success' : '' %>">
          <td class="bold"><%= p.name %></td>
          <% @bets.each do |b| %>
            <td>
              <% if @entries[b.id][p.name].present? %>
                <% if p.id == @participant.id || @participant.scoresheet.expired? %>
                  <%= @entries[b.id][p.name] %>
                <% else %>
                  <%= check_mark('Submitted but hidden') %>
                <% end %>
              <% else %>
                <%= question_mark('No Entry Yet')%>
              <% end %>
            </td>
          <% end %>
        </tr>
      <% end %>
      <% if @results %>
        <tr class="info bold">
          <td>Results</td>
          <% @bets.each do |b| %>
            <td><%= @entries[b.id]['result'] %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
  <% unless @participant.scoresheet.expired? %>
    <%= link_to 'Modify', "#{@participant.key}/edit", class: 'btn btn-success' %>
  <% end %>
</div>
<% if @participant.scoresheet.expired? && @results %>
  <div class="well">
    <h4>Differentials</h4>
    <table class="table table-striped table-hover table-condensed">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <% @bets.each do |b| %>
            <th><%= b.name %></th>
          <% end %>
          <% if @scoresheet.consolation? %>
            <th>Consolation</th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @participants.each do |p| %>
          <tr class="<%= p.id == @participant.id ? 'success' : '' %>">
            <td class="bold"><%= p.name %></td>
            <% @bets.each do |b| %>
              <td><%= @differentials[b.id][p.name] %></td>
            <% end %>
            <% if @scoresheet.consolation? %>
              <td><%= @consolation[p.name] %>
            <% end %>
        <% end %>
        <tr class="info bold">
          <td>Winners</td>
          <% @bets.each do |b| %>
            <td><%= @winners[b.id].join(",") %></td>
          <% end %>
          <% if @scoresheet.consolation? %>
            <td><%= @winners['consolation'].join(",") %></td>
          <% end %>
        </tr>
      </tbody>
    </table>
  </div>
  
  <div class="well">
    <h4>Standings</h4>
    <table class="table table-striped table-hover table-condensed">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <% @bets.each do |b| %>
            <th><%= b.name %></th>
          <% end %>
          <% if @scoresheet.consolation? %>
            <th>Consolation</th>
          <% end %>
          <th>Total</th>
        </tr>
      </thead>
      <tbody> 
        <% @participants.each do |p| %>
          <tr class="<%= p.id == @participant.id ? 'success' : '' %>">
            <td><%= p.name %></td>
            <% @bets.each do |b| %>
              <td><%= colorize_points(@standings[p.name][b.id]) %></td>
            <% end %>
            <% if @scoresheet.consolation? %>
              <td><%= colorize_points(@standings[p.name]['consolation']) %></td>
            <% end %>
            <td class="bold"><%= colorize_points(@standings[p.name].values.sum) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  
<% end %>